---
import Header from "@/components/Header.astro";
import Layout from "@/layouts/Layout.astro";
import Main from "@/layouts/Main.astro";
import axiosInstance from "@/lib/axios";
import { getSession } from "auth-astro/server";

const session = await getSession(Astro.request);

const userResponse = await axiosInstance.get("/user/me", {
  headers: {
    Authorization: `Bearer ${session?.user?.token}`,
  },
});

const user = userResponse.data.user;
---

<Layout title="Profile">
  <Header />
  <Main />
  <div class="mx-auto max-w-4xl rounded-lg bg-white p-6 shadow-md">
    <div class="flex items-center space-x-4">
      <img
        src={user.profileImage}
        alt="Profile Image"
        class="h-24 w-24 rounded-full shadow-lg"
      />
      <div>
        <h1 class="text-3xl font-bold text-gray-800">{user.username}</h1>
        <p class="text-sm text-gray-500">Email: {user.email}</p>
      </div>
    </div>
    <div class="mt-6">
      <h2 class="text-xl font-semibold text-gray-700">Account Overview</h2>
      <p class="text-gray-600">
        Welcome to your profile page, {user.username}!
      </p>
    </div>
  </div>
</Layout>
